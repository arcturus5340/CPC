{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="../static/@chrisoakman/chessboardjs/dist/chessboard-1.0.0.css"/>
</head>
<body>

    <a href="/add_board/">Новая доска</a>

    <script src="{% static "jquery/dist/jquery.js" %}"></script>
    <script src="{% static "chess.js/chess.js" %}"></script>
    <script src="{% static "@chrisoakman/chessboardjs/dist/chessboard-1.0.0.js" %}"></script>

    {% for chess_board in ChessBoards %}
        <div id="board-{{ chess_board }}" style="width: 400px"></div>
    {% endfor %}

    <script>

        function update_boards(){
            $.ajax({
                url: '/get_boards/',
                type: 'POST',
                data: {
                    csrfmiddlewaretoken: '{{ csrf_token }}',
                },
                success: function(response) {
                    for (var id in response['ChessBoards']){
                        console.log(response['ChessBoards'][id]);
                        Chessboard('board-'+id, response['ChessBoards'][id]);
                        window.setTimeout(update_boards, 1000)
                    }
                },
                error: function() {
                }
            })
        }

        window.setTimeout(update_boards, 1000)

    </script>
</body>
</html>